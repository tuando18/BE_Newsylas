<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel='stylesheet' href='/stylesheets/post_detail.css' />
    <title>{{title}}</title>
</head>

<body>
    <main class="w-100 ">
        <div class="container-fluid pt-4 pl-0 hidden" id="post-container">
            <div class="wrapper-post d-flex p-3 mb-3">
                <div class="content-main">
                    <div class="title mb-3 d-flex">
                        <img src="https://placehold.co/50x50" id="post-avatar" alt="" width="70" height="70"
                            class="rounded-circle mr-3">
                        <div class="">
                            <h2 id="post-title" class="m-0">Tiêu đề bài viết</h2>
                            <span class="d-flex align-item-center m-0">
                                <span id="name-user-up" class="user-up mr-3">Admin</span>
                                <p id="time-up" class="time-up mt-1 p-0">11 hours ago</p>
                            </span>
                        </div>
                    </div>
                    <div id="post-content" class="content">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed nonummy ipsum dolor. Nam quam nunc,
                        blandit vel sapien non, tristique tempor nisi. Proin non est in ipsum tincidunt scelerisque. Sed
                        ac justo vel velit ultricies tempor. Aliquam erat volutpat
                    </div>
                    <div id="wrapper-image-post" class="image pt-1 mt-2 d-flex"></div>
                    <div class="post-icons ml-auto pt-2">
                        <span class="icon mr-3">
                            <i class="bi bi-heart-fill"></i> <span id="like-count">0</span>
                        </span>
                        <span class="icon">
                            <i class="bi bi-chat-fill"></i> <span id="comment-count">0</span>
                        </span>
                    </div>
                </div>
            </div>
            
        </div>
    </main>
    <script>
        const postId = '{{postId}}';

        fetch(`http://localhost:3000/api/v1/posts/get-post-by-id/${postId}`)
            .then(response => response.json())
            .then(data => {
                console.log(data);
                document.getElementById('post-title').textContent = data.data.title;
                document.getElementById('time-up').textContent = timeAgo(data.data.createdAt);
                document.getElementById('post-content').textContent = data.data.content;
                document.getElementById('post-avatar').src = "https://placehold.co/50x50";

                // Hiển thị hình ảnh nếu có
                const images = data.data.image; // Giả sử hình ảnh nằm trong thuộc tính 'image'
                const wrapperImagePost = document.getElementById('wrapper-image-post');
                if (images.length > 0) {
                    images.forEach(imageUrl => {
                        const imgElement = document.createElement('img');
                        imgElement.style.marginRight = '10px';
                        imgElement.src = imageUrl; // Gán URL của hình ảnh
                        imgElement.alt = 'Hình ảnh bài viết'; // Gán thuộc tính alt
                        wrapperImagePost.appendChild(imgElement); // Thêm vào wrapper
                    });
                } else {
                    wrapperImagePost.style.display = 'none'; // Ẩn nếu không có ảnh
                }

                // Hiện container sau khi đã fetch xong
                document.getElementById('post-container').classList.remove('hidden');
                        console.log(postId);

            });

        const timeAgo = (date) => {
            const now = new Date();
            const postDate = new Date(date);
            const diff = Math.floor((now - postDate) / 1000); // Chênh lệch thời gian tính bằng giây

            if (diff < 60) return `${diff} seconds ago`;
            const minutes = Math.floor(diff / 60);
            if (minutes < 60) return `${minutes} minutes ago`;
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours} hours ago`;
            const days = Math.floor(hours / 24);
            return `${days} days ago`;
        }
    </script>
</body>

</html>
